"# üí∞ PWR Finan√ßas - Sistema de Gest√£o Financeira Pessoal

Sistema web mobile-first + PWA completo para gest√£o financeira pessoal com multi-tenant, autentica√ß√£o por e-mail/senha, upload/c√¢mera com OCR, funcionamento offline com sincroniza√ß√£o autom√°tica, dashboards completos e status "no vermelho".

## üöÄ Tecnologias

### Backend
- **NestJS** - Framework Node.js robusto e escal√°vel
- **Prisma ORM** - Modelagem de dados type-safe com PostgreSQL
- **PostgreSQL** - Banco de dados relacional
- **Redis + BullMQ** - Filas para processamento ass√≠ncrono
- **MinIO** - Storage S3-compatible para arquivos
- **Tesseract.js** - OCR para extra√ß√£o de dados de recibos/notas
- **JWT** - Autentica√ß√£o stateless
- **Swagger** - Documenta√ß√£o autom√°tica da API

### Frontend
- **Next.js 14** - React framework com App Router
- **TypeScript** - Type safety em todo o projeto
- **Tailwind CSS** - Estiliza√ß√£o utility-first
- **React Query** - Gerenciamento de estado servidor
- **Dexie.js** - IndexedDB para cache offline
- **Workbox** - Service Worker para PWA
- **Recharts** - Gr√°ficos e dashboards
- **Zod** - Valida√ß√£o de schemas

### Infraestrutura
- **Docker Compose** - Orquestra√ß√£o de containers
- **pnpm** - Gerenciador de pacotes eficiente
- **ESLint + Prettier** - Qualidade de c√≥digo
- **Jest + Cypress** - Testes unit√°rios e E2E

## üìÅ Estrutura do Projeto

```
pwr-financas/
‚îú‚îÄ‚îÄ apps/
‚îÇ   ‚îú‚îÄ‚îÄ web/                 # Frontend Next.js 14
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app/        # App Router (p√°ginas)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/ # Componentes React
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lib/        # Utilidades (API, DB, Auth)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ public/         # Assets est√°ticos + PWA
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ api/                # Backend NestJS
‚îÇ       ‚îú‚îÄ‚îÄ src/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ auth/       # Autentica√ß√£o JWT
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ accounts/   # Contas banc√°rias
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ cards/      # Cart√µes de cr√©dito
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ transactions/ # Transa√ß√µes
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ analytics/  # Dashboards e relat√≥rios
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ ocr/        # Processamento OCR
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ prisma/     # Cliente Prisma
‚îÇ       ‚îú‚îÄ‚îÄ prisma/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ schema.prisma # Modelo de dados
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ seed.ts       # Dados iniciais
‚îÇ       ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ packages/
‚îÇ   ‚îú‚îÄ‚îÄ types/              # Schemas Zod + tipos TS compartilhados
‚îÇ   ‚îî‚îÄ‚îÄ ui/                 # Componentes UI reutiliz√°veis (futuro)
‚îÇ
‚îú‚îÄ‚îÄ infra/
‚îÇ   ‚îî‚îÄ‚îÄ docker-compose.yaml # Postgres + Redis + MinIO
‚îÇ
‚îú‚îÄ‚îÄ package.json            # Scripts raiz do monorepo
‚îú‚îÄ‚îÄ pnpm-workspace.yaml     # Configura√ß√£o workspace
‚îî‚îÄ‚îÄ README.md
```

## üõ†Ô∏è Setup e Instala√ß√£o

### Pr√©-requisitos

- **Node.js** >= 18.0
- **pnpm** >= 8.0 (Instale com: `npm install -g pnpm`)
- **Docker Desktop** - [Download aqui](https://www.docker.com/products/docker-desktop)

### üöÄ In√≠cio R√°pido (5 minutos)

#### Windows (CMD ou PowerShell)

```cmd
# 1. Entre na pasta do projeto
cd "G:\Meu Drive\Pessoal\Sistema financeiro pessoal\finaceiro-pessoal"

# 2. Instale as depend√™ncias (pode demorar 2-5 minutos)
pnpm install

# 3. Configure os arquivos de ambiente
copy apps\api\.env.example apps\api\.env
echo NEXT_PUBLIC_API_URL=http://localhost:4000 > apps\web\.env.local

# 4. Inicie a infraestrutura Docker
pnpm docker:up

# 5. Aguarde 15 segundos para os containers iniciarem
timeout /t 15 /nobreak

# 6. Gere o cliente Prisma
cd apps\api
pnpm prisma generate
cd ..\..

# 7. Execute as migra√ß√µes do banco
pnpm db:migrate

# 8. Popule o banco com dados iniciais
pnpm db:seed

# 9. Inicie o servidor de desenvolvimento
pnpm dev
```

#### Linux/Mac

```bash
# 1. Entre na pasta do projeto
cd finaceiro-pessoal

# 2. Instale as depend√™ncias
pnpm install

# 3. Configure os arquivos de ambiente
cp apps/api/.env.example apps/api/.env
echo "NEXT_PUBLIC_API_URL=http://localhost:4000" > apps/web/.env.local

# 4. Inicie a infraestrutura Docker
pnpm docker:up

# 5. Aguarde 15 segundos
sleep 15

# 6. Gere o cliente Prisma
cd apps/api && pnpm prisma generate && cd ../..

# 7. Execute as migra√ß√µes
pnpm db:migrate

# 8. Popule o banco
pnpm db:seed

# 9. Inicie o desenvolvimento
pnpm dev
```

### ‚úÖ Verificar se est√° funcionando

Ap√≥s executar os comandos acima, voc√™ deve ter:

- ‚úÖ **Frontend** rodando em http://localhost:3000
- ‚úÖ **Backend API** rodando em http://localhost:4000
- ‚úÖ **API Docs (Swagger)** em http://localhost:4000/api/docs
- ‚úÖ **PostgreSQL** na porta 5432
- ‚úÖ **Redis** na porta 6379
- ‚úÖ **MinIO Console** em http://localhost:9001 (user: `minioadmin` / password: `minioadmin`)

### üéØ Primeiro Acesso

1. Abra http://localhost:3000
2. Fa√ßa login com as credenciais demo:
   - **E-mail:** demo@pwrfinancas.com
   - **Senha:** demo123456
3. Explore o sistema!

### üîß Detalhamento dos Passos

<details>
<summary><strong>1. Instalar depend√™ncias</strong></summary>

```bash
pnpm install
```

**O que faz:** Instala todas as depend√™ncias do monorepo (backend, frontend, packages).  
**Tempo estimado:** 2-5 minutos  
**Tamanho:** ~500MB de node_modules
</details>

<details>
<summary><strong>2. Configurar vari√°veis de ambiente</strong></summary>

**Backend:**
```bash
cp apps/api/.env.example apps/api/.env
```

**Frontend:**
```bash
echo "NEXT_PUBLIC_API_URL=http://localhost:4000" > apps/web/.env.local
```

**O que faz:** Cria arquivos `.env` com configura√ß√µes padr√£o para desenvolvimento local.
</details>

<details>
<summary><strong>3. Iniciar infraestrutura Docker</strong></summary>

```bash
pnpm docker:up
```

**O que faz:** Inicia os containers:
- PostgreSQL 15 (porta 5432)
- Redis 7 (porta 6379)
- MinIO (portas 9000 e 9001)

**Importante:** Aguarde 10-15 segundos para os healthchecks passarem antes de continuar.
</details>

<details>
<summary><strong>4. Gerar Prisma Client</strong></summary>

```bash
cd apps/api
pnpm prisma generate
cd ../..
```

**O que faz:** Gera o cliente TypeScript do Prisma baseado no schema. Este passo √© necess√°rio para que o backend possa se comunicar com o banco.
</details>

<details>
<summary><strong>5. Executar migra√ß√µes</strong></summary>

```bash
pnpm db:migrate
```

**O que faz:** Cria todas as tabelas no PostgreSQL conforme o schema Prisma.
</details>

<details>
<summary><strong>6. Popular banco de dados (seed)</strong></summary>

```bash
pnpm db:seed
```

**O que faz:** Insere dados iniciais:
- Usu√°rio demo: `demo@pwrfinancas.com` / `demo123456`
- 14 categorias padr√£o (Alimenta√ß√£o, Transporte, Sa√∫de, etc.)
- Conta corrente demo com saldo inicial
- Cart√£o de cr√©dito demo
- 3 or√ßamentos mensais
- Transa√ß√µes de exemplo
</details>

<details>
<summary><strong>7. Iniciar desenvolvimento</strong></summary>

```bash
pnpm dev
```

**O que faz:** Inicia em modo de desenvolvimento:
- Backend API em http://localhost:4000
- Frontend Web em http://localhost:3000
- Hot reload habilitado em ambos
</details>

## üéÆ Uso

### Acessar o sistema

1. Abra http://localhost:3000
2. Fa√ßa login com:
   - **E-mail:** demo@pwrfinancas.com
   - **Senha:** demo123456
3. Explore o dashboard!

### Criar nova transa√ß√£o

1. Clique no FAB (bot√£o flutuante "+")
2. Preencha: valor, categoria, conta/cart√£o, descri√ß√£o
3. (Opcional) Adicione foto do recibo via c√¢mera ou upload
4. Salve

### Modo Offline

1. Abra o app enquanto online
2. Desconecte da internet
3. Continue criando transa√ß√µes (ser√£o armazenadas localmente)
4. Ao reconectar, sincroniza√ß√£o autom√°tica acontece via Background Sync

## üìä Scripts Dispon√≠veis

### Raiz do monorepo

```bash
pnpm dev          # Inicia todos os servi√ßos em desenvolvimento
pnpm build        # Build de produ√ß√£o (todos os pacotes)
pnpm test         # Executa todos os testes
pnpm lint         # Verifica qualidade de c√≥digo
pnpm format       # Formata c√≥digo com Prettier

pnpm db:migrate   # Executa migra√ß√µes Prisma
pnpm db:seed      # Popula banco com dados iniciais
pnpm db:studio    # Abre Prisma Studio (visualizador de dados)

pnpm docker:up    # Inicia containers Docker
pnpm docker:down  # Para containers Docker
pnpm docker:logs  # Visualiza logs dos containers
```

## üß™ Testes

### Testes Unit√°rios (Backend)

```bash
cd apps/api
pnpm test
```

### Testes E2E (Frontend)

```bash
cd apps/web
pnpm test:e2e
```

## ÔøΩ Troubleshooting

### Erro: "pnpm: command not found"

```bash
npm install -g pnpm
```

### Erro: "Cannot connect to database"

```bash
# Reinicie o Docker
pnpm docker:down
# Aguarde 5 segundos
pnpm docker:up
# Aguarde 15 segundos
pnpm db:migrate
```

### Erro: "Port already in use"

**Porta 5432 (PostgreSQL):**
- Voc√™ tem um Postgres local rodando
- Pare o servi√ßo ou mude a porta no `infra/docker-compose.yaml`

**Porta 3000 (Frontend) ou 4000 (Backend):**
- Mate o processo usando a porta:
  ```cmd
  # Windows
  netstat -ano | findstr :3000
  taskkill /PID <n√∫mero_do_processo> /F
  ```

### Erro: "Module @prisma/client not found"

```bash
cd apps/api
pnpm prisma generate
cd ../..
```

### Docker n√£o inicia

- Verifique se o Docker Desktop est√° rodando
- No Windows, verifique se a virtualiza√ß√£o est√° habilitada na BIOS
- Reinicie o Docker Desktop

### PWA n√£o instala

- Use **localhost** ou **HTTPS** (obrigat√≥rio para PWA)
- Limpe o cache do navegador (Ctrl+Shift+Delete)
- Verifique Service Worker em DevTools ‚Üí Application

### Depend√™ncias desatualizadas

```bash
pnpm install
cd apps/api && pnpm prisma generate && cd ../..
```

## ÔøΩüì¶ Deploy

### Backend (API)

1. Configure as vari√°veis de ambiente para produ√ß√£o
2. Execute migra√ß√µes:
   ```bash
   cd apps/api
   pnpm prisma migrate deploy
   ```
3. Build:
   ```bash
   pnpm build
   ```
4. Inicie:
   ```bash
   pnpm start
   ```

### Frontend (Web)

1. Configure `NEXT_PUBLIC_API_URL` para o endpoint da API em produ√ß√£o
2. Build:
   ```bash
   cd apps/web
   pnpm build
   ```
3. Inicie:
   ```bash
   pnpm start
   ```

## üîí Seguran√ßa

- **Senhas hasheadas** com bcryptjs (salt rounds: 10)
- **JWT tokens** com expira√ß√£o de 7 dias
- **Multi-tenant estrito**: todas as queries filtram por `user_id`
- **Valida√ß√£o de input** com Zod em frontend e backend
- **CORS configurado** para aceitar apenas origem do frontend

## üìà Hist√≥rico de Melhorias

Esta se√ß√£o documenta todas as melhorias incrementais feitas no projeto ap√≥s a vers√£o inicial.

### Vers√£o 1.0.0 - Release Inicial (16/10/2025)
- ‚úÖ Sistema completo de gest√£o financeira pessoal
- ‚úÖ Backend NestJS com Prisma + PostgreSQL
- ‚úÖ Frontend Next.js 14 com PWA
- ‚úÖ Autentica√ß√£o JWT multi-tenant
- ‚úÖ CRUD completo (accounts, cards, categories, transactions)
- ‚úÖ Analytics e dashboards
- ‚úÖ Suporte offline com IndexedDB
- ‚úÖ Docker Compose para desenvolvimento
- ‚úÖ Seeds com dados demo
- ‚úÖ Documenta√ß√£o completa

### Melhorias Futuras
_Esta se√ß√£o ser√° atualizada conforme novas funcionalidades forem adicionadas._

**Formato de documenta√ß√£o:**
```markdown
### [Data] - [T√≠tulo da Melhoria]
- üéØ **Solicita√ß√£o:** [O que foi pedido]
- ‚úÖ **Implementado:** [O que foi feito]
- üìù **Arquivos modificados:** [Lista de arquivos]
- üöÄ **Como usar:** [Instru√ß√µes de uso]
```

---

## üìö Recursos Adicionais

- üìñ [QUICKSTART.md](./QUICKSTART.md) - Guia r√°pido de 5 minutos
- üìã [PROJETO-COMPLETO.md](./PROJETO-COMPLETO.md) - Resumo completo do projeto
- üîß [COMANDOS-SETUP.md](./COMANDOS-SETUP.md) - Todos os comandos de instala√ß√£o
- üìù [CHANGELOG.md](./CHANGELOG.md) - Hist√≥rico de vers√µes detalhado
- ü§ù [CONTRIBUTING.md](./CONTRIBUTING.md) - Guia de contribui√ß√£o
- üåê [API Docs](http://localhost:4000/api/docs) - Documenta√ß√£o Swagger (quando rodando)

## ü§ù Contribuindo

Contribui√ß√µes s√£o bem-vindas! Veja [CONTRIBUTING.md](./CONTRIBUTING.md) para mais detalhes.

## üìù Licen√ßa

MIT License - Veja [LICENSE](./LICENSE) para detalhes.

---

**Desenvolvido com ‚ù§Ô∏è para gest√£o financeira inteligente**

**Vers√£o:** 1.0.0  
**√öltima atualiza√ß√£o:** 16/10/2025"  
